dogfood-dogweb-failed:
  stage: dogfood
  tags: ["arch:amd64"]
  needs: ["dogfood-dogweb-trigger"]
  when: on_failure
  script:
    - exit 0

dogfood-dogweb:
  stage: dogfood
  tags: ["arch:amd64"]
  needs: ["dogfood-dogweb-trigger"]
  when: on_success
  script:
    - exit 0

dogfood-dogweb-trigger:
  stage: dogfood
  trigger:
    project: DataDog/dogweb
    strategy: depend
    branch: emmett.butler/ddtrace-unstable-dogfooding
  allow_failure: true
  variables:
    UPSTREAM_PIPELINE_ID: $CI_PIPELINE_ID
    UPSTREAM_PROJECT_URL: $CI_PROJECT_URL
    DDTRACE_COMMIT_TO_INSTALL: $CI_COMMIT_SHA
    UPSTREAM_COMMIT_BRANCH: $CI_COMMIT_BRANCH
    UPSTREAM_COMMIT_AUTHOR: $CI_COMMIT_AUTHOR
    UPSTREAM_COMMIT_TITLE: $CI_COMMIT_TITLE
    UPSTREAM_COMMIT_TAG: $CI_COMMIT_TAG
    UPSTREAM_PROJECT_NAME: $CI_PROJECT_NAME
    UPSTREAM_GITLAB_USER_LOGIN: $GITLAB_USER_LOGIN
    UPSTREAM_GITLAB_USER_EMAIL: $GITLAB_USER_EMAIL
