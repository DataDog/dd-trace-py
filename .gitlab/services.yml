.services:
  ddagent:
    name: datadog/agent:latest
    alias: ddagent
    variables:
      DD_HOSTNAME: ddagent
      LOG_LEVEL: ERROR
      DD_REMOTE_CONFIGURATION_ENABLED: true
      DD_SITE: datadoghq.com
      DD_API_KEY: invalid_but_this_is_fine
      DD_REMOTE_CONFIGURATION_KEY: invalid_but_this_is_fine
      DD_REMOTE_CONFIGURATION_REFRESH_INTERVAL: 5s
      DD_DOGSTATSD_NON_LOCAL_TRAFFIC: true
  testagent:
    name: ghcr.io/datadog/dd-apm-test-agent/ddapm-test-agent:v1.17.0
    alias: testagent
    variables:
      LOG_LEVEL: INFO
      SNAPSHOT_DIR: ${CI_PROJECT_DIR}/tests/snapshots
      SNAPSHOT_CI: 1
      PORT: 9126
      DD_POOL_TRACE_CHECK_FAILURES: true
      DD_DISABLE_ERROR_RESPONSES: true
      ENABLED_CHECKS: trace_content_length,trace_stall,meta_tracer_version_header,trace_count_header,trace_peer_service,trace_dd_service
  redis:
    name: registry.ddbuild.io/redis:7.0.7
    alias: redis
  elasticsearch:
    name: registry.ddbuild.io/images/mirror/library/elasticsearch:7.17.23
    alias: elasticsearch
    variables:
      discovery.type: single-node
      xpack.security.enabled: false
  opensearch:
    name: registry.ddbuild.io/images/mirror/opensearchproject/opensearch:1.3.13
    alias: opensearch
    variables:
      DISABLE_SECURITY_PLUGIN: true
      discovery.type: single-node
  memcached:
    name: registry.ddbuild.io/images/mirror/library/memcached:1.5-alpine
    alias: memcached
  postgres:
    name: registry.ddbuild.io/images/mirror/postgres:12-alpine
    alias: postgres
    variables:
      POSTGRES_PASSWORD: postgres
      POSTGRES_USER: postgres
      POSTGRES_DB: postgres
