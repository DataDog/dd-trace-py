# Thresholds set based on guidance in https://datadoghq.atlassian.net/wiki/spaces/APMINT/pages/5070193198/How+to+set+up+pre-release+performance+quality+gates#How-to-choose-thresholds-for-pre-release-gates%3F

experiments:
  - name: SLO Check
    steps:
      - name: SLO Check
        run: fail_on_breach
        scenarios:
          # flask_simple
          - name: flasksimple-tracer
            thresholds:
              - execution_time < 3.65 ms
              - max_rss_usage < 52.50 MB
          - name: flasksimple-profiler
            thresholds:
              - execution_time < 2.10 ms
              - max_rss_usage < 43.80 MB
          - name: flasksimple-debugger
            thresholds:
              - execution_time < 2.00 ms
              - max_rss_usage < 42.50 MB
          - name: flasksimple-iast-get
            thresholds:
              - execution_time < 2.00 ms
              - max_rss_usage < 44.75 MB
          - name: flasksimple-appsec-get
            thresholds:
              - execution_time < 4.75 ms
              - max_rss_usage < 62.10 MB
          - name: flasksimple-appsec-post
            thresholds:
              - execution_time < 6.75 ms
              - max_rss_usage < 62.40 MB
          - name: flasksimple-appsec-telemetry
            thresholds:
              - execution_time < 4.75 ms
              - max_rss_usage < 62.40 MB
          # span
          - name: span-add-event
            thresholds:
              - execution_time < 26.20 ms
              - max_rss_usage < 47.20 MB
          - name: span-add-metrics
            thresholds:
              - execution_time < 98.35 ms
              - max_rss_usage < 933.25 MB
          - name: span-add-tags
            thresholds:
              - execution_time < 168.55 ms
              - max_rss_usage < 934.70 MB
          - name: span-get-context
            thresholds:
              - execution_time < 23.70 ms
              - max_rss_usage < 46.05 MB
          - name: span-is-recording
            thresholds:
              - execution_time < 23.90 ms
              - max_rss_usage < 46.05 MB
          - name: span-record-exception
            thresholds:
              - execution_time < 44.50 ms
              - max_rss_usage < 39.25 MB
          - name: span-set-status
            thresholds:
              - execution_time < 26.00 ms
              - max_rss_usage < 46.05 MB
          - name: span-start
            thresholds:
              - execution_time < 23.50 ms
              - max_rss_usage < 46.05 MB
          - name: span-start-finish
            thresholds:
              - execution_time < 52.50 ms
              - max_rss_usage < 28.35 MB
          - name: span-start-finish-telemetry
            thresholds:
              - execution_time < 55.30 ms
              - max_rss_usage < 28.35 MB
          - name: span-start-finish-traceid128
            thresholds:
              - execution_time < 56.05 ms
              - max_rss_usage < 28.35 MB
          - name: span-start-traceid128
            thresholds:
              - execution_time < 24.60 ms
              - max_rss_usage < 46.05 MB
          - name: span-update-name
            thresholds:
              - execution_time < 24.10 ms
              - max_rss_usage < 46.50 MB
          # tracer
          - name: tracer-large
            thresholds:
              - execution_time < 32.95 ms
              - max_rss_usage < 29.50 MB
          - name: tracer-medium
            thresholds:
              - execution_time < 3.20 ms
              - max_rss_usage < 28.35 MB
          - name: tracer-small
            thresholds:
              - execution_time < 0.37 ms
              - max_rss_usage < 28.35 MB
