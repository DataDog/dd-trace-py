spec:
  inputs:
    env:
      type: string
      default: ""
    services:
      type: string
      default: ""
---
steps:
  - name: pull_and_run
    script:
    # Retry pulls in case they fail
    - for i in {1..3}; do docker-compose pull -q << parameters.services >> && break || sleep 3; done
    - << parameters.env >> docker-compose up -d << parameters.services >>
  - name: logs
    command: docker-compose logs -f
    background: true
