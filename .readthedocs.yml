version: 2
build:
  os: ubuntu-22.04
  tools:
    python: "3.10"
  commands:
    - git fetch --unshallow || true
    - curl -L https://github.com/pypa/hatch/releases/download/hatch-v1.8.1/hatch-1.8.1-x86_64-unknown-linux-gnu.tar.gz | tar zx
    - mv hatch-1.8.1-* hatch
    - install -t /usr/local/bin hatch
    - hatch -q
    - curl https://sh.rustup.rs -sSf | sh -s -- --default-toolchain stable -y
    - echo 'export PATH="$HOME/.cargo/bin:$PATH"' >> "$BASH_ENV"
    - hatch -v run docs:sphinx-build -W -b html docs docs/_build/html
    - mv docs/_build $READTHEDOCS_OUTPUT
