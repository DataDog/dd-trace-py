id: span-metrics-subscript-write
valid:
  # Reads (not writes) are fine
  - val = span._metrics["_dd.top_level"]
  - |
    if "_dd.measured" in span._metrics:
        handle(span._metrics["_dd.measured"])
  # Objects whose name ends with 'context' are excluded by constraint
  - context._metrics["key"] = 1
  - span_context._metrics["_dd.measured"] = 1
  - self.trace_context._metrics["key"] = value
  # Correct API usage
  - span._set_numeric_attribute("_dd.top_level", 1)
  - ctx.span._set_numeric_attribute(_SPAN_MEASURED_KEY, 1)
  # Different attribute name (not ._metrics)
  - span._metrics_dict["key"] = 1

invalid:
  # Direct span variable
  - span._metrics["_dd.top_level"] = 1
  # Member attribute
  - ctx.span._metrics[_SPAN_MEASURED_KEY] = 1
  # PID metric
  - span._metrics["system.pid"] = os.getpid()
  # Multi-line block
  - |
    span._metrics[redisx.ARGS_LEN] = len(args)
    span._metrics[redisx.PIPELINE_LEN] = pipeline_len
