[package]
name = "ddtrace-native"
version = "0.1.0"
edition = "2021"
resolver = "2"

[profile.release]
lto = true
debug = "line-tables-only"
opt-level = 's'
codegen-units = 1

[features]
crashtracker = ["dep:anyhow", "dep:datadog-crashtracker"]
profiling = ["dep:datadog-profiling-ffi"]

[dependencies]
anyhow = { version = "1.0", optional = true }
datadog-crashtracker = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c", optional = true }
datadog-ddsketch = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c" }
datadog-library-config = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c" }
datadog-log = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c" }
data-pipeline = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c" }
datadog-profiling-ffi = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c", optional = true, features = [
    "cbindgen",
] }
ddcommon = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c" }
ddcommon-ffi = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c" }
libc = "0.2.177"
pyo3 = { version = "0.25", features = ["extension-module", "anyhow"] }
tracing = { version = "0.1", default-features = false }
pyo3-ffi = "0.25"
cc = "1.2.39"

[build-dependencies]
pyo3-build-config = "0.25"
pyo3-ffi = "0.25"
cc = "1.2.39"
build_common = { git = "https://github.com/DataDog/libdatadog", rev = "7d1bfee1c077a214e4cfcdb0ccfac707491a2c4c", features = [
    "cbindgen",
] }

[lib]
name = "_native"
path = "lib.rs"
crate-type = ["cdylib"]

[net]
# Use git binary from the system instead of the built-in git client
# "Setting this to true can be helpful if you have special authentication requirements that Cargo does not support."
git-fetch-with-cli = true
