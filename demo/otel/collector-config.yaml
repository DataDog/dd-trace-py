receivers:
  otlp:
    protocols:
      grpc:
        endpoint: 0.0.0.0:4317
      http:
        endpoint: 0.0.0.0:4318

processors:
  batch:
    timeout: 10s
    send_batch_size: 1024

  # Add resource attributes
  resource:
    attributes:
      - key: deployment.environment
        value: ${env:ENVIRONMENT}
        action: upsert

exporters:
  # Datadog exporter
  datadog:
    api:
      site: ${env:DD_SITE}
      key: ${env:DD_API_KEY}

    # Optional: Configure hostname
    # hostname: my-host

    # Optional: Configure tags
    # tags:
    #   - env:production
    #   - team:backend

  # Debug exporter (useful for troubleshooting)
  debug:
    verbosity: detailed
    sampling_initial: 5
    sampling_thereafter: 200

service:
  pipelines:
    traces:
      receivers: [otlp]
      processors: [batch, resource]
      exporters: [datadog]

    # Uncomment to also log traces locally for debugging
    # traces/debug:
    #   receivers: [otlp]
    #   processors: [batch]
    #   exporters: [debug]

