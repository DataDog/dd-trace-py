[[
  {
    "name": "ray.job",
    "service": "error_in_task",
    "resource": "ray.job",
    "trace_id": 0,
    "span_id": 1,
    "parent_id": 0,
    "type": "ray",
    "error": 1,
    "meta": {
      "_dd.base_service": "ray.dashboard",
      "_dd.hostname": "docker-desktop",
      "_dd.p.dm": "-0",
      "_dd.p.tid": "68d519e300000000",
      "component": "ray",
      "error.message": "Job entrypoint command failed with exit code 1, last available logs (truncated to 20,000 chars):\n  File \"/home/bits/project/.riot/venv_py3135_mock_pytest_pytest-mock_coverage_pytest-cov_opentracing_hypothesis6451_ray[default]/lib/python3.13/site-packages/ray/_private/worker.py\", line 968, in get_objects\n    raise value.as_instanceof_cause()\nray.exceptions.RayTaskError(ValueError): \u001b[36mray::add_one()\u001b[39m (pid=2133, ip=192.168.65.3)\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 73, in wrapped_function\n    return _wrap_task_execution(function, *args, **kwargs)\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 100, in _wrap_task_execution\n    result = wrapped(*args, **kwargs)\n  File \"/home/bits/project/tests/contrib/ray/jobs/error_in_task.py\", line 9, in add_one\n    raise ValueError(\"foo\")\nValueError: foo\n",
      "language": "python",
      "ray.job.message": "Job entrypoint command failed with exit code 1, last available logs (truncated to 20,000 chars):\n  File \"/home/bits/project/.riot/venv_py3135_mock_pytest_pytest-mock_coverage_pytest-cov_opentracing_hypothesis6451_ray[default]/lib/python3.13/site-packages/ray/_private/worker.py\", line 968, in get_objects\n    raise value.as_instanceof_cause()\nray.exceptions.RayTaskError(ValueError): \u001b[36mray::add_one()\u001b[39m (pid=2133, ip=192.168.65.3)\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 73, in wrapped_function\n    return _wrap_task_execution(function, *args, **kwargs)\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 100, in _wrap_task_execution\n    result = wrapped(*args, **kwargs)\n  File \"/home/bits/project/tests/contrib/ray/jobs/error_in_task.py\", line 9, in add_one\n    raise ValueError(\"foo\")\nValueError: foo\n",
      "ray.job.status": "FAILED",
      "ray.job_id": "01000000",
      "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
      "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
      "ray.worker_id": "01000000ffffffffffffffffffffffffffffffffffffffffffffffff",
      "runtime-id": "798e60e00b9045d6b646bc133a4197a8"
    },
    "metrics": {
      "_dd.djm.enabled": 1,
      "_dd.filter.kept": 1,
      "_dd.measured": 1,
      "_dd.top_level": 1,
      "_dd.tracer_kr": 1.0,
      "_sampling_priority_v1": 2,
      "process_id": 1028
    },
    "duration": 7942458990,
    "start": 1758796259264193637
  },
     {
       "name": "ray.job.submit",
       "service": "error_in_task",
       "resource": "ray.job.submit",
       "trace_id": 0,
       "span_id": 2,
       "parent_id": 1,
       "type": "ray",
       "error": 0,
       "meta": {
         "_dd.base_service": "ray.dashboard",
         "component": "ray",
         "ray.job.submit_status": "success",
         "ray.job_id": "01000000",
         "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
         "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
         "ray.worker_id": "01000000ffffffffffffffffffffffffffffffffffffffffffffffff",
         "span.kind": "producer"
       },
       "metrics": {
         "_dd.djm.enabled": 1,
         "_dd.filter.kept": 1,
         "_dd.measured": 1,
         "_sampling_priority_v1": 2
       },
       "duration": 50500,
       "start": 1758796259264420637
     },
     {
       "name": "JobSupervisor.run.remote()",
       "service": "error_in_task",
       "resource": "JobSupervisor.run.remote()",
       "trace_id": 0,
       "span_id": 3,
       "parent_id": 1,
       "type": "ray",
       "error": 0,
       "meta": {
         "_dd.base_service": "ray.dashboard",
         "component": "ray",
         "ray.actor_method.args": "[]",
         "ray.actor_method.kwargs": "{'_start_signal_actor': None, 'resources_specified': False}",
         "ray.job_id": "01000000",
         "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
         "ray.worker_id": "01000000ffffffffffffffffffffffffffffffffffffffffffffffff",
         "span.kind": "producer"
       },
       "metrics": {
         "_dd.djm.enabled": 1,
         "_dd.filter.kept": 1,
         "_dd.measured": 1,
         "_sampling_priority_v1": 2
       },
       "duration": 593416,
       "start": 1758796259267976929
     },
        {
          "name": "JobSupervisor.run",
          "service": "error_in_task",
          "resource": "JobSupervisor.run",
          "trace_id": 0,
          "span_id": 4,
          "parent_id": 3,
          "type": "ray",
          "error": 1,
          "meta": {
            "_dd.base_service": "ray._private.workers",
            "_dd.p.tid": "68d519e300000000",
            "_dd.parent_id": "10c82e38403f01ff",
            "component": "ray",
            "error.message": "",
            "error.stack": "Traceback (most recent call last):\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/span_manager.py\", line 27, in long_running_ray_span\n    yield span\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 280, in _traced_run_method\n    raise e\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 273, in _traced_run_method\n    await method(self, *args, **kwargs)\n  File \"/home/bits/project/.riot/venv_py3135_mock_pytest_pytest-mock_coverage_pytest-cov_opentracing_hypothesis6451_ray[default]/lib/python3.13/site-packages/ray/dashboard/modules/job/job_supervisor.py\", line 472, in run\n    ray.actor.exit_actor()\n    ~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/bits/project/.riot/venv_py3135_mock_pytest_pytest-mock_coverage_pytest-cov_opentracing_hypothesis6451_ray[default]/lib/python3.13/site-packages/ray/actor.py\", line 2387, in exit_actor\n    raise AsyncioActorExit()\nray.exceptions.AsyncioActorExit\n",
            "error.type": "ray.exceptions.AsyncioActorExit",
            "language": "python",
            "ray.actor_id": "40aa06718f736bc781ac3d3801000000",
            "ray.job_id": "01000000",
            "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
            "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
            "ray.task_id": "359ec6ce30d3ca2d40aa06718f736bc781ac3d3801000000",
            "ray.worker_id": "8f0d789adf362001616e5de77bc3ee8af7a34ad6bbf30e5f6789272b",
            "runtime-id": "a41f0c5d93cf4a51b72254a4fb3b9dbe",
            "span.kind": "consumer",
            "traceparent": "00-68d519e300000000aa231ae5202da375-10c82e38403f01ff-00",
            "tracestate": "dd=p:10c82e38403f01ff"
          },
          "metrics": {
            "_dd.djm.enabled": 1,
            "_dd.filter.kept": 1,
            "_dd.measured": 1,
            "_dd.top_level": 1,
            "_dd.tracer_kr": 1.0,
            "_sampling_priority_v1": 2,
            "process_id": 2026
          },
          "duration": 6368376239,
          "start": 1758796260175615804
        },
           {
             "name": "JobSupervisor._get_driver_env_vars",
             "service": "error_in_task",
             "resource": "JobSupervisor._get_driver_env_vars",
             "trace_id": 0,
             "span_id": 5,
             "parent_id": 4,
             "type": "ray",
             "error": 0,
             "meta": {
               "_dd.base_service": "ray._private.workers",
               "component": "ray",
               "ray.actor_id": "40aa06718f736bc781ac3d3801000000",
               "ray.actor_method.args": "(False,)",
               "ray.actor_method.kwargs": "{}",
               "ray.job_id": "01000000",
               "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
               "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
               "ray.task_id": "359ec6ce30d3ca2d40aa06718f736bc781ac3d3801000000",
               "ray.worker_id": "8f0d789adf362001616e5de77bc3ee8af7a34ad6bbf30e5f6789272b",
               "span.kind": "consumer"
             },
             "metrics": {
               "_dd.djm.enabled": 1,
               "_dd.filter.kept": 1,
               "_dd.measured": 1,
               "_sampling_priority_v1": 2
             },
             "duration": 1429417,
             "start": 1758796260177081054
           },
              {
                "name": "JobSupervisor._get_driver_runtime_env",
                "service": "error_in_task",
                "resource": "JobSupervisor._get_driver_runtime_env",
                "trace_id": 0,
                "span_id": 11,
                "parent_id": 5,
                "type": "ray",
                "error": 0,
                "meta": {
                  "_dd.base_service": "ray._private.workers",
                  "component": "ray",
                  "ray.actor_id": "40aa06718f736bc781ac3d3801000000",
                  "ray.actor_method.args": "(False,)",
                  "ray.actor_method.kwargs": "{}",
                  "ray.job_id": "01000000",
                  "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
                  "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
                  "ray.task_id": "359ec6ce30d3ca2d40aa06718f736bc781ac3d3801000000",
                  "ray.worker_id": "8f0d789adf362001616e5de77bc3ee8af7a34ad6bbf30e5f6789272b",
                  "span.kind": "consumer"
                },
                "metrics": {
                  "_dd.djm.enabled": 1,
                  "_dd.filter.kept": 1,
                  "_dd.measured": 1,
                  "_sampling_priority_v1": 2
                },
                "duration": 53666,
                "start": 1758796260178427513
              },
           {
             "name": "exec error_in_task.py",
             "service": "error_in_task",
             "resource": "exec error_in_task.py",
             "trace_id": 0,
             "span_id": 6,
             "parent_id": 4,
             "type": "ray",
             "error": 0,
             "meta": {
               "_dd.base_service": "ray._private.workers",
               "component": "ray",
               "ray.actor_id": "40aa06718f736bc781ac3d3801000000",
               "ray.job_id": "01000000",
               "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
               "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
               "ray.task_id": "359ec6ce30d3ca2d40aa06718f736bc781ac3d3801000000",
               "ray.worker_id": "8f0d789adf362001616e5de77bc3ee8af7a34ad6bbf30e5f6789272b",
               "span.kind": "consumer"
             },
             "metrics": {
               "_dd.djm.enabled": 1,
               "_dd.filter.kept": 1,
               "_dd.measured": 1,
               "_sampling_priority_v1": 2
             },
             "duration": 426042,
             "start": 1758796260178697054
           },
           {
             "name": "__main__.add_one.remote()",
             "service": "error_in_task",
             "resource": "__main__.add_one.remote()",
             "trace_id": 0,
             "span_id": 7,
             "parent_id": 4,
             "type": "ray",
             "error": 0,
             "meta": {
               "_dd.base_service": "project",
               "_dd.p.tid": "68d519e300000000",
               "_dd.parent_id": "0ea8a213e7122ff8",
               "component": "ray",
               "language": "python",
               "ray.job_id": "03000000",
               "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
               "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
               "ray.task.args": "(0,)",
               "ray.task.kwargs": "{}",
               "ray.task.submit_status": "success",
               "ray.worker_id": "03000000ffffffffffffffffffffffffffffffffffffffffffffffff",
               "runtime-id": "7d4fe638cf2f466881e3d5720e2d35bc",
               "span.kind": "producer",
               "traceparent": "00-68d519e300000000aa231ae5202da375-0ea8a213e7122ff8-00",
               "tracestate": "dd=p:0ea8a213e7122ff8;s:0"
             },
             "metrics": {
               "_dd.djm.enabled": 1,
               "_dd.filter.kept": 1,
               "_dd.measured": 1,
               "_dd.top_level": 1,
               "_dd.tracer_kr": 1.0,
               "_sampling_priority_v1": 2,
               "process_id": 2076
             },
             "duration": 3269958,
             "start": 1758796260814791263
           },
              {
                "name": "__main__.add_one",
                "service": "error_in_task",
                "resource": "__main__.add_one",
                "trace_id": 0,
                "span_id": 12,
                "parent_id": 7,
                "type": "ray",
                "error": 1,
                "meta": {
                  "_dd.base_service": "ray._private.workers",
                  "_dd.p.tid": "68d519e300000000",
                  "_dd.parent_id": "57565ac385776825",
                  "component": "ray",
                  "error.message": "foo",
                  "error.stack": "Traceback (most recent call last):\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/span_manager.py\", line 27, in long_running_ray_span\n    yield span\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 100, in _wrap_task_execution\n    result = wrapped(*args, **kwargs)\n  File \"/home/bits/project/tests/contrib/ray/jobs/error_in_task.py\", line 9, in add_one\n    raise ValueError(\"foo\")\nValueError: foo\n",
                  "error.type": "builtins.ValueError",
                  "language": "python",
                  "ray.job_id": "03000000",
                  "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
                  "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
                  "ray.task.args": "(0,)",
                  "ray.task.kwargs": "{}",
                  "ray.task.status": "error",
                  "ray.task_id": "fa31b89f94899135ffffffffffffffffffffffff03000000",
                  "ray.worker_id": "7464d3cf8d49cbc46b9afee87470de80b91b0c3f07b0603bce4385a7",
                  "runtime-id": "dcde9d7a14c24d329d9a78bd9c8cea82",
                  "span.kind": "consumer",
                  "traceparent": "00-68d519e300000000aa231ae5202da375-57565ac385776825-00",
                  "tracestate": "dd=p:57565ac385776825;s:0"
                },
                "metrics": {
                  "_dd.djm.enabled": 1,
                  "_dd.filter.kept": 1,
                  "_dd.measured": 1,
                  "_dd.top_level": 1,
                  "_dd.tracer_kr": 1.0,
                  "_sampling_priority_v1": 2,
                  "process_id": 2135
                },
                "duration": 2167042,
                "start": 1758796262594673597
              },
           {
             "name": "__main__.add_one.remote()",
             "service": "error_in_task",
             "resource": "__main__.add_one.remote()",
             "trace_id": 0,
             "span_id": 8,
             "parent_id": 4,
             "type": "ray",
             "error": 0,
             "meta": {
               "_dd.base_service": "project",
               "_dd.p.tid": "68d519e300000000",
               "_dd.parent_id": "0ea8a213e7122ff8",
               "component": "ray",
               "language": "python",
               "ray.job_id": "03000000",
               "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
               "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
               "ray.task.args": "(1,)",
               "ray.task.kwargs": "{}",
               "ray.task.submit_status": "success",
               "ray.worker_id": "03000000ffffffffffffffffffffffffffffffffffffffffffffffff",
               "runtime-id": "7d4fe638cf2f466881e3d5720e2d35bc",
               "span.kind": "producer",
               "traceparent": "00-68d519e300000000aa231ae5202da375-0ea8a213e7122ff8-00",
               "tracestate": "dd=p:0ea8a213e7122ff8;s:0"
             },
             "metrics": {
               "_dd.djm.enabled": 1,
               "_dd.filter.kept": 1,
               "_dd.measured": 1,
               "_dd.top_level": 1,
               "_dd.tracer_kr": 1.0,
               "_sampling_priority_v1": 2,
               "process_id": 2076
             },
             "duration": 251792,
             "start": 1758796260820320263
           },
              {
                "name": "__main__.add_one",
                "service": "error_in_task",
                "resource": "__main__.add_one",
                "trace_id": 0,
                "span_id": 13,
                "parent_id": 8,
                "type": "ray",
                "error": 1,
                "meta": {
                  "_dd.base_service": "ray._private.workers",
                  "_dd.p.tid": "68d519e300000000",
                  "_dd.parent_id": "a9f51165f7738ffe",
                  "component": "ray",
                  "error.message": "foo",
                  "error.stack": "Traceback (most recent call last):\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/span_manager.py\", line 27, in long_running_ray_span\n    yield span\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 100, in _wrap_task_execution\n    result = wrapped(*args, **kwargs)\n  File \"/home/bits/project/tests/contrib/ray/jobs/error_in_task.py\", line 9, in add_one\n    raise ValueError(\"foo\")\nValueError: foo\n",
                  "error.type": "builtins.ValueError",
                  "language": "python",
                  "ray.job_id": "03000000",
                  "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
                  "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
                  "ray.task.args": "(1,)",
                  "ray.task.kwargs": "{}",
                  "ray.task.status": "error",
                  "ray.task_id": "44bfa4a5859b21acffffffffffffffffffffffff03000000",
                  "ray.worker_id": "e69529326fa5be74a4920c191484b062a0d2c15448ebce9fe16413f1",
                  "runtime-id": "1035b28304064c5db91dab103360f8f0",
                  "span.kind": "consumer",
                  "traceparent": "00-68d519e300000000aa231ae5202da375-a9f51165f7738ffe-00",
                  "tracestate": "dd=p:a9f51165f7738ffe;s:0"
                },
                "metrics": {
                  "_dd.djm.enabled": 1,
                  "_dd.filter.kept": 1,
                  "_dd.measured": 1,
                  "_dd.top_level": 1,
                  "_dd.tracer_kr": 1.0,
                  "_sampling_priority_v1": 2,
                  "process_id": 2136
                },
                "duration": 2037000,
                "start": 1758796262608517055
              },
           {
             "name": "__main__.add_one.remote()",
             "service": "error_in_task",
             "resource": "__main__.add_one.remote()",
             "trace_id": 0,
             "span_id": 9,
             "parent_id": 4,
             "type": "ray",
             "error": 0,
             "meta": {
               "_dd.base_service": "project",
               "_dd.p.tid": "68d519e300000000",
               "_dd.parent_id": "0ea8a213e7122ff8",
               "component": "ray",
               "language": "python",
               "ray.job_id": "03000000",
               "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
               "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
               "ray.task.args": "(2,)",
               "ray.task.kwargs": "{}",
               "ray.task.submit_status": "success",
               "ray.worker_id": "03000000ffffffffffffffffffffffffffffffffffffffffffffffff",
               "runtime-id": "7d4fe638cf2f466881e3d5720e2d35bc",
               "span.kind": "producer",
               "traceparent": "00-68d519e300000000aa231ae5202da375-0ea8a213e7122ff8-00",
               "tracestate": "dd=p:0ea8a213e7122ff8;s:0"
             },
             "metrics": {
               "_dd.djm.enabled": 1,
               "_dd.filter.kept": 1,
               "_dd.measured": 1,
               "_dd.top_level": 1,
               "_dd.tracer_kr": 1.0,
               "_sampling_priority_v1": 2,
               "process_id": 2076
             },
             "duration": 196708,
             "start": 1758796260822458513
           },
              {
                "name": "__main__.add_one",
                "service": "error_in_task",
                "resource": "__main__.add_one",
                "trace_id": 0,
                "span_id": 14,
                "parent_id": 9,
                "type": "ray",
                "error": 1,
                "meta": {
                  "_dd.base_service": "ray._private.workers",
                  "_dd.p.tid": "68d519e300000000",
                  "_dd.parent_id": "27ef7c0ec66fb90a",
                  "component": "ray",
                  "error.message": "foo",
                  "error.stack": "Traceback (most recent call last):\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/span_manager.py\", line 27, in long_running_ray_span\n    yield span\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 100, in _wrap_task_execution\n    result = wrapped(*args, **kwargs)\n  File \"/home/bits/project/tests/contrib/ray/jobs/error_in_task.py\", line 9, in add_one\n    raise ValueError(\"foo\")\nValueError: foo\n",
                  "error.type": "builtins.ValueError",
                  "language": "python",
                  "ray.job_id": "03000000",
                  "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
                  "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
                  "ray.task.args": "(2,)",
                  "ray.task.kwargs": "{}",
                  "ray.task.status": "error",
                  "ray.task_id": "0ab01f2d6283d719ffffffffffffffffffffffff03000000",
                  "ray.worker_id": "b4fcc4d4e714ca768531752406c164bebe488e68cfbd50fbad9c58dd",
                  "runtime-id": "16917291026242a9bab5e0d2587929d3",
                  "span.kind": "consumer",
                  "traceparent": "00-68d519e300000000aa231ae5202da375-27ef7c0ec66fb90a-00",
                  "tracestate": "dd=p:27ef7c0ec66fb90a;s:0"
                },
                "metrics": {
                  "_dd.djm.enabled": 1,
                  "_dd.filter.kept": 1,
                  "_dd.measured": 1,
                  "_dd.top_level": 1,
                  "_dd.tracer_kr": 1.0,
                  "_sampling_priority_v1": 2,
                  "process_id": 2133
                },
                "duration": 3203000,
                "start": 1758796262592853305
              },
           {
             "name": "__main__.add_one.remote()",
             "service": "error_in_task",
             "resource": "__main__.add_one.remote()",
             "trace_id": 0,
             "span_id": 10,
             "parent_id": 4,
             "type": "ray",
             "error": 0,
             "meta": {
               "_dd.base_service": "project",
               "_dd.p.tid": "68d519e300000000",
               "_dd.parent_id": "0ea8a213e7122ff8",
               "component": "ray",
               "language": "python",
               "ray.job_id": "03000000",
               "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
               "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
               "ray.task.args": "(3,)",
               "ray.task.kwargs": "{}",
               "ray.task.submit_status": "success",
               "ray.worker_id": "03000000ffffffffffffffffffffffffffffffffffffffffffffffff",
               "runtime-id": "7d4fe638cf2f466881e3d5720e2d35bc",
               "span.kind": "producer",
               "traceparent": "00-68d519e300000000aa231ae5202da375-0ea8a213e7122ff8-00",
               "tracestate": "dd=p:0ea8a213e7122ff8;s:0"
             },
             "metrics": {
               "_dd.djm.enabled": 1,
               "_dd.filter.kept": 1,
               "_dd.measured": 1,
               "_dd.top_level": 1,
               "_dd.tracer_kr": 1.0,
               "_sampling_priority_v1": 2,
               "process_id": 2076
             },
             "duration": 218709,
             "start": 1758796260824275971
           },
              {
                "name": "__main__.add_one",
                "service": "error_in_task",
                "resource": "__main__.add_one",
                "trace_id": 0,
                "span_id": 15,
                "parent_id": 10,
                "type": "ray",
                "error": 1,
                "meta": {
                  "_dd.base_service": "ray._private.workers",
                  "_dd.p.tid": "68d519e300000000",
                  "_dd.parent_id": "d834445621a54e79",
                  "component": "ray",
                  "error.message": "foo",
                  "error.stack": "Traceback (most recent call last):\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/span_manager.py\", line 27, in long_running_ray_span\n    yield span\n  File \"/home/bits/project/ddtrace/contrib/internal/ray/patch.py\", line 100, in _wrap_task_execution\n    result = wrapped(*args, **kwargs)\n  File \"/home/bits/project/tests/contrib/ray/jobs/error_in_task.py\", line 9, in add_one\n    raise ValueError(\"foo\")\nValueError: foo\n",
                  "error.type": "builtins.ValueError",
                  "language": "python",
                  "ray.job_id": "03000000",
                  "ray.node_id": "e70d0305678c4f61e7d36b430737a925e453cbb81dd02b9aad4e3400",
                  "ray.submission_id": "raysubmit_2Fp9jUnRG2dKmWLS",
                  "ray.task.args": "(3,)",
                  "ray.task.kwargs": "{}",
                  "ray.task.status": "error",
                  "ray.task_id": "62ffec03f52574bdffffffffffffffffffffffff03000000",
                  "ray.worker_id": "badd6a7c3d2f7254058eb225d15d2afb3de5aa1eebaa93db9775244d",
                  "runtime-id": "34400b064b0b4f229bb65b024dbbbd7a",
                  "span.kind": "consumer",
                  "traceparent": "00-68d519e300000000aa231ae5202da375-d834445621a54e79-00",
                  "tracestate": "dd=p:d834445621a54e79;s:0"
                },
                "metrics": {
                  "_dd.djm.enabled": 1,
                  "_dd.filter.kept": 1,
                  "_dd.measured": 1,
                  "_dd.top_level": 1,
                  "_dd.tracer_kr": 1.0,
                  "_sampling_priority_v1": 2,
                  "process_id": 2134
                },
                "duration": 3732208,
                "start": 1758796262617203389
              }]]
