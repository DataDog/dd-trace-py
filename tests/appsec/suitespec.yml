components:
  appsec:
  - ddtrace/appsec/*
  - ddtrace/settings/asm.py
  appsec_iast:
  - ddtrace/appsec/iast/*


suites:
  appsec:
    runner: riot
    parallelism: 6
    retry: 2
    pattern: appsec$
    snapshot: true
    paths:
    - '@bootstrap'
    - '@core'
    - '@tracing'
    - '@appsec'
    - '@appsec_iast'
    - '@remoteconfig'
    - tests/appsec/*
  appsec_iast:
    runner: riot
    services:
    - postgres
    env:
      TEST_POSTGRES_HOST: postgres
    parallelism: 6
    retry: 2
    timeout: 25m
    pattern: appsec_iast$
    snapshot: true
    paths:
    - '@bootstrap'
    - '@core'
    - '@tracing'
    - '@appsec'
    - '@appsec_iast'
    - '@remoteconfig'
    - tests/appsec/iast/*
  appsec_iast_memcheck:
    runner: riot
    env:
      CI_DEBUG_TRACE: 'true'
      PYTEST_ADDOPTS: -v -s
    parallelism: 4
    retry: 2
    snapshot: true
    paths:
    - '@bootstrap'
    - '@core'
    - '@tracing'
    - '@appsec'
    - '@appsec_iast'
    - '@remoteconfig'
    - tests/appsec/iast/*
    - tests/appsec/iast_memcheck/*
  appsec_threats_django:
    runner: hatch
    parallelism: 12
    retry: 2
    paths:
    - '@bootstrap'
    - '@core'
    - '@tracing'
    - '@appsec'
    - '@appsec_iast'
    - '@asgi'
    - '@wsgi'
    - '@django'
    - '@remoteconfig'
    - tests/appsec/*
    - tests/appsec/contrib_appsec/*
  appsec_threats_flask:
    runner: hatch
    parallelism: 10
    retry: 2
    paths:
    - '@bootstrap'
    - '@core'
    - '@tracing'
    - '@appsec'
    - '@appsec_iast'
    - '@asgi'
    - '@wsgi'
    - '@flask'
    - '@remoteconfig'
    - tests/appsec/*
    - tests/appsec/contrib_appsec/*
  appsec_threats_fastapi:
    runner: hatch
    parallelism: 9
    retry: 2
    paths:
    - '@bootstrap'
    - '@core'
    - '@tracing'
    - '@appsec'
    - '@appsec_iast'
    - '@asgi'
    - '@wsgi'
    - '@fastapi'
    - '@starlette'
    - '@remoteconfig'
    - tests/appsec/*
    - tests/appsec/contrib_appsec/*
  appsec_iast_native:
    runner: hatch
    parallelism: 6
    retry: 2
    paths:
    - '@bootstrap'
    - '@core'
    - '@tracing'
    - '@appsec'
    - '@appsec_iast'
    - '@remoteconfig'
